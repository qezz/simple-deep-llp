# input data (e.g. images)
inp = np.array([[[ 0.,  1.,  1.,  0.,  0.,  1.], # image 1
                 [ 0.,  1.,  1.,  0.,  0.,  1.],
                 [ 0.,  1.,  1.,  0.,  1.,  1.],
                 [ 1.,  1.,  1.,  0.,  0.,  1.],
                 [ 1.,  1.,  1.,  0.,  0.,  1.],
                 [ 0.,  1.,  1.,  1.,  0.,  0.]],

                [[ 0.,  1.,  1.,  0.,  0.,  1.], # image 2
                 [ 0.,  1.,  1.,  0.,  0.,  1.],
                 [ 0.,  1.,  1.,  0.,  1.,  1.],
                 [ 1.,  1.,  1.,  0.,  0.,  1.],
                 [ 1.,  1.,  1.,  0.,  0.,  1.],
                 [ 0.,  1.,  1.,  1.,  0.,  0.]],

                [[ 0.,  1.,  1.,  0.,  0.,  1.], # image 3
                 [ 0.,  1.,  1.,  0.,  0.,  1.],
                 [ 0.,  1.,  1.,  0.,  1.,  1.],
                 [ 1.,  1.,  1.,  0.,  0.,  1.],
                 [ 1.,  1.,  1.,  0.,  0.,  1.],
                 [ 0.,  1.,  1.,  1.,  0.,  0.]],

                [[ 0.,  1.,  1.,  0.,  0.,  1.], # image 4
                 [ 0.,  1.,  1.,  0.,  0.,  1.],
                 [ 0.,  1.,  1.,  0.,  1.,  1.],
                 [ 1.,  1.,  1.,  0.,  0.,  1.],
                 [ 1.,  1.,  1.,  0.,  0.,  1.],
                 [ 0.,  1.,  1.,  1.,  0.,  0.]],

                [[ 0.,  1.,  1.,  0.,  0.,  1.], # image 5
                 [ 0.,  1.,  1.,  0.,  0.,  1.],
                 [ 0.,  1.,  1.,  0.,  1.,  1.],
                 [ 1.,  1.,  1.,  0.,  0.,  1.],
                 [ 1.,  1.,  1.,  0.,  0.,  1.],
                 [ 0.,  1.,  1.,  1.,  0.,  0.]],

                [[ 0.,  1.,  1.,  0.,  0.,  1.], # image 6
                 [ 0.,  1.,  1.,  0.,  0.,  1.],
                 [ 0.,  1.,  1.,  0.,  1.,  1.],
                 [ 1.,  1.,  1.,  0.,  0.,  1.],
                 [ 1.,  1.,  1.,  0.,  0.,  1.],
                 [ 0.,  1.,  1.,  1.,  0.,  0.]]], dtype="float32")

# labels, classes
outp = np.array([[ 0.,  0.,  0.,  1.,  0.,  0.],
                 [ 0.,  1.,  1.,  0.,  0.,  1.],
                 [ 0.,  0.,  1.,  1.,  1.,  1.],
                 [ 0.,  0.,  0.,  1.,  1.,  1.],
                 [ 0.,  0.,  0.,  0.,  1.,  1.],
                 [ 0.,  0.,  0.,  0.,  1.,  1.]])

a = create_bags(inp, outp, 6)

validate = np.array([[ 0.0,  1/6,  1/3,  0.5,  2/3,  5/6],
                     [ 0.0,  1/6,  1/3,  0.5,  2/3,  5/6],
                     [ 0.0,  1/6,  1/3,  0.5,  2/3,  5/6],
                     [ 0.0,  1/6,  1/3,  0.5,  2/3,  5/6],
                     [ 0.0,  1/6,  1/3,  0.5,  2/3,  5/6],
                     [ 0.0,  1/6,  1/3,  0.5,  2/3,  5/6]], dtype="float32")

print(np.abs(np.sum(a - validate)) < 10 ** (-7))
